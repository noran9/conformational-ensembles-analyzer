# Conformational analysis of protein structural ensembles
Structural bioinformatics project for analysis and comparison of protein ensembles for intrinsically disordered proteins (IDPs).

### Dependencies

To make sure the working environment matches all needed dependencies run `pip install -r requirements.txt` or check if all used packages are installed:

- biopython
- dssp
- numpy
- matplotlib
- seaborn
- networkx
- scipy
- sklearn

## Usage

Add all input structures in PDB file format in the /data directory. Main script help output:

    python3 main.py -h
    > usage: main.py [-h] [-s SINGLE] [-d] [-se SINGLE_ENSEMBLE] [-e] [-g GRAPH] [-p P] [-i] [-dend]
                   [-paired PAIRWISE_DENDROGRAM [PAIRWISE_DENDROGRAM ...]] [-l] [-fi]
                   
    optional arguments:
    -h, --help            show this help message and exit
    -s SINGLE, --single SINGLE
                        Compute single conformation features for a given .pdb file in the data folder. Add the structure ID as
                        parameter.
    -d, --data            Compute single conformation features for all .pdb files in the data folder.
    -se SINGLE_ENSEMBLE, --single_ensemble SINGLE_ENSEMBLE
                        Compute ensemble features for a given .pdb file in the data folder. Add the structure ID as parameter.
    -e, --ensemble        Compute ensemble features for all computed single conformation features.
    -g GRAPH, --graph GRAPH
                        Compute similarity graph for a given structure. Add the structure ID as parameter.
    -p P                  Optional argument for the size of the graph. Default value is 0. Use values 1, 2, 3.
    -i, --image           Generate PyMOL image from the last computed graph cluster centers.
    -dend, --dendrogram   Compute heatmap and dendrogram for similarity among all computed ensembles.
    -paired PAIRWISE_DENDROGRAM [PAIRWISE_DENDROGRAM ...], --pairwise_dendrogram PAIRWISE_DENDROGRAM [PAIRWISE_DENDROGRAM ...]
                        Compute heatmap and dendrogram for similarity some ensembles. Add two or more structure IDs as parameters
    -l, --local           Compute local score: RMSD variance among all computed ensembles
    -fi, --features_images
                        Compute pairwise comparison plots and summary plots per ensemble
                     
 ## Recommended order of usage:

1. Run `python3 main.py -s SINGLE` to compute single conformation features for one PDB file in the `\data` folder and add the structure ID as the SINGLE parameter.
Example: `python3 main.py -s PED00154e006`. For each conformation in the file the following features are computed:
- Radius of gyration
- Relative accesible surface area (ASA)
- Secondary structure
- Distance matrix between alpha atoms

For each conformation a feature file is generated. All files can be found in the folder `single-conformations-features-*SINGLE*`.

2. To compute single conformations features for all PDB files in the `\data` folder run `python3 main.py -d`

3. To visualize the similarity between conformations, clustering is performed based on selected features: the radius of gyration and secondary structure only.
For each PDB flie, a graph can be generated by running `python3 main.pg -g GRAPH` where each node represents the cluster center and weights are computed using the features distance.
Cluster centers are saved in the generated `cluster-centers` file.
Example graph image for the file PED00154e008: `python3 main.py -g PED00154e008`:

![](https://github.com/noran9/conformational-ensembles-analyzer/blob/main/images/graph-PED00154e008.png)

The number of nodes can be modified by using the argument p. When using higher values, more conformations similar to the cluster centers are plotted. 
Example usage: `python3 main.py g PED00154e008 -p 1`. The best values for the parameter p are from 1 to 3.

4. To visualise the ccomputed cluster centers in PyMOL run `python3 main.py -i`. The structure used in the graph is split into conformation files in `/data/split-structure/` folder.
The cluster center conformations are translated in the folder `/translated-files`. Afterwards a PyMOL images is generated. Example for PED00154e006:

![](https://github.com/noran9/conformational-ensembles-analyzer/blob/main/images/pymol_PED00154e006.png)

**Note**: If PyMOL does not launch or shows error, the script `pymol-image.py` can be loaded in PyMOL to generate the image. The values for structure name, optimal k and closest list
can be found in the `cluster-centers` file.

5. Run `python3 main.py -se SINGLE_ENSEMBLE` to compute ensemble features for one of the PDB files in the `\data` folder. Example: `python3 main.py -se PED00154e006`.
A file for the ensemble is generated in the folder `ensemble-features` with the following features:

- Radius of gyration for each conformation
- Mean accesible surface area among conformations
- Mean secondary structure among conformations
- Mean distance matrix among conformations
- Standard deviation of the distance matrix

6. To compute single conformations features for all PDB files in the `\data` folder run `python3 main.py -e`.

7. To visualise the similarity between the features of different ensembles run `python3 main.py -dend`. A heatmap with dendrogram between all ensembles for which features are
already computed is generated. Example of the plot:

![](https://github.com/noran9/conformational-ensembles-analyzer/blob/main/images/clustermap.png)

8. To generate the plot between two or more chosen ensembles, run `python3 main.py -paired [PAIRWISE_DENDROGRAM ...]`. 
Example: `python3 main.py -paired PED00154e006 PED00154e007`.

9. To generate plot for the local score per residue among ensembles run `python3 main.py -l`

![](https://github.com/noran9/conformational-ensembles-analyzer/blob/main/images/local-rmsd-score.png)

11. To compute summary images for each ensemble run `python3 main.py -fi`. 

![](https://github.com/noran9/conformational-ensembles-analyzer/blob/main/images/Features_PED00154e006.png)
